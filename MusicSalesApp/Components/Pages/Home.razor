@page "/"
@using MusicSalesApp.Components.Shared
@using MusicSalesApp.Components.Pages
@using Syncfusion.Blazor.Buttons
@using Syncfusion.Blazor.Cards
@inherits HomeModel

<PageTitle>Home</PageTitle>

<div class="home-container">
    <h1>Welcome to Stream Tunes!</h1>

    <p>Discover and enjoy unlimited music streaming!</p>
    
    @if (_isAuthenticated && (_recommendedPlaylist.Any() || _likedSongsPlaylist != null))
    {
        <div class="recommended-playlist-section">
            <h2>Your Playlists</h2>
            <div class="playlists-page-grid">
                @if (_recommendedPlaylist.Any())
                {
                    <PlaylistCard 
                        PlaylistName="Recommended For You"
                        SongCount="@_recommendedPlaylist.Count"
                        Description="Songs you might enjoy based on your preferences"
                        ShowActions="false"
                        CssClass="recommended-playlist-card"
                        OnPlay="@PlayRecommendedPlaylist" />
                }
                @if (_likedSongsPlaylist != null && _likedSongsCount > 0)
                {
                    <PlaylistCard 
                        PlaylistName="Liked Songs"
                        SongCount="@_likedSongsCount"
                        Description="Songs you've liked"
                        ShowActions="false"
                        CssClass="liked-songs-playlist-card"
                        OnPlay="@PlayLikedSongsPlaylist" />
                }
            </div>
        </div>
    }
    else if (_isAuthenticated && _loadingRecommendations)
    {
        <div class="recommended-playlist-section">
            <h2>Your Playlists</h2>
            <p>Loading...</p>
        </div>
    }
    
    <div class="featured-music-section">
        <div class="featured-music-header">
            <h2>Featured Music</h2>
            <a href="/music-library" class="music-library-link">View All</a>
        </div>
        <MusicLibrary ShowHomePageFeatured="true" />
    </div>
    
    @if (!_hasActiveSubscription)
    {
        <div class="subscription-offer">
            <SfCard>
                <CardHeader Title="Unlimited Music Streaming" />
                <CardContent>
                    <h3>Subscribe for just $@_subscriptionPrice per month!</h3>
                    <p>Get unlimited access to all music on our platform.</p>
                    <ul>
                        <li>Stream any song, anytime</li>
                        <li>No ads or interruptions</li>
                        <li>Cancel anytime</li>
                    </ul>
                </CardContent>
                <CardFooter>
                    <SfButton OnClick="@(() => NavigationManager.NavigateTo("/manage-account"))" CssClass="e-btn e-primary">
                        Sign Up for Monthly Subscription
                    </SfButton>
                </CardFooter>
            </SfCard>
        </div>
    }
</div>
