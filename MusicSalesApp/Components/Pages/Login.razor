@page "/login"
@inherits LoginModel

<PageTitle>Login</PageTitle>

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <SfCard>
                <CardHeader Title="Login" />
                <CardContent>
                    @if (!string.IsNullOrEmpty(errorMessage))
                    {
                        <SfMessage Severity="MessageSeverity.Error">@errorMessage</SfMessage>
                    }

                    <form method="post" action="/account/login">
                        @* AntiForgery token *@
                        <input name="__RequestVerificationToken" type="hidden" value="@antiForgeryToken" />
                        
                        <div class="mb-3">
                            <label for="username" class="e-label">Username or Email</label>
                            <SfTextBox @bind-Value="@usernameValue" ID="username" Name="username" Placeholder="Enter username or email" CssClass="e-outline" HtmlAttributes="@(new Dictionary<string, object> { { "required", "required" } })" />
                        </div>

                        <div class="mb-3">
                            <label for="password" class="e-label">Password</label>
                            <SfTextBox ID="password" Name="password" Type="InputType.Password" Placeholder="Enter password" CssClass="e-outline" HtmlAttributes="@(new Dictionary<string, object> { { "required", "required" } })" />
                        </div>

                        <div class="mb-3">
                            <SfCheckBox @bind-Checked="@reactivateAccount" Label="Reactivate my suspended account" TChecked="bool" />
                            <input type="hidden" name="reactivateAccount" value="@reactivateAccount.ToString().ToLower()" />
                        </div>

                        <input type="hidden" name="returnUrl" value="/" />

                        <div class="d-grid mb-3">
                            <SfButton Type="ButtonType.Submit" IsPrimary="true" Content="Login with Password" CssClass="e-btn e-primary" />
                        </div>
                    </form>

                    <!-- Passkey Login Section -->
                    <div class="text-center mb-3">
                        <hr />
                        <span class="text-muted">OR</span>
                        <hr />
                    </div>

                    <div class="d-grid">
                        <SfButton IsPrimary="false" Content="Login with Passkey" CssClass="e-btn e-outline" OnClick="LoginWithPasskey" />
                    </div>
                </CardContent>
            </SfCard>
            @if (isDevelopment)
            {
                <div class="mt-3 text-center text-muted">
                    <small>Hint: Use email "admin@app.com" or "user@app.com" with password "Password_123"</small>
                </div>
            }
        </div>
    </div>
</div>
